<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Quick Start to SIHR â€¢ SIHR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start to SIHR">
<meta property="og:description" content="SIHR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<script src="../darkswitch.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIHR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/SIHR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IntroMethod.pdf">Intro of Debiasing Methods</a>
    </li>
    <li>
      <a href="../articles/IntroUsage.pdf">Intro of Usage</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
          <a href="#" id="css-toggle-btn">
            <span class="fas fa-adjust fa-lg"></span>
          </a>
        </li>
        
        <li>
  <a href="https://github.com/zywang0701/SIHR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
        
        


      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quick Start to SIHR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zywang0701/SIHR/blob/HEAD/vignettes/SIHR.Rmd" class="external-link"><code>vignettes/SIHR.Rmd</code></a></small>
      <div class="hidden name"><code>SIHR.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="usage-of-functions-lf-and-qf-in-linearlogistic-regression-settings">Usage of functions LF and QF in Linear/Logistic regression
settings<a class="anchor" aria-label="anchor" href="#usage-of-functions-lf-and-qf-in-linearlogistic-regression-settings"></a>
</h2>
<p>We propose a few examples on the usage of SIHR to simulated dataset.
We will show how to conduct inference for linear functionals (LF) and
quadratic functionals (QF) on linear and logistic regression settings,
respectively.</p>
<p>Load the library:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zywang0701/SIHR" class="external-link">SIHR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="linear-regression-setting">Linear Regression Setting<a class="anchor" aria-label="anchor" href="#linear-regression-setting"></a>
</h3>
<p>We consider the setting that <span class="math inline">\(n=200,
p=150\)</span> with <span class="math display">\[
X_i \sim N(\textbf{0}_p, \textbf{I}_p),\; Y_i = \alpha + X_i^\intercal
\beta + \epsilon_i, \; \epsilon_i\sim N(0,1),\;
\textrm{where }\; \alpha = -0.5, \; \beta = (0.5, \textbf{1}_4,
\textbf{0}_{p-5}).
\]</span> Our goal is to construct valid inference for objectives:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\beta_1 = 0.5\)</span></li>
<li><span class="math inline">\(\beta_1 + \beta_2 = 1.5\)</span></li>
<li>
<span class="math inline">\(\beta_{G}^\intercal \Sigma_{G,G}
\beta_{G} = 3.25\)</span>, where <span class="math inline">\(\Sigma=\mathbb{E}[X_i^\intercal X_i] =
\textbf{I}_p\)</span> and <span class="math inline">\(G=\{1,2,3,4\}\)</span>.</li>
</ol>
<p>The 1st and 2nd objectives will be achieved togther by <em>LF(
)</em>, while the 3d objective will be conducted with <em>QF(
)</em>.</p>
<p>Generate Data</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">200</span>; <span class="va">p</span> <span class="op">=</span> <span class="fl">150</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="lf-linear-functionals">LF: Linear Functionals<a class="anchor" aria-label="anchor" href="#lf-linear-functionals"></a>
</h4>
<p>Loadings for Linear Functionals</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loading1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># for 1st objective, true value = 0.5</span></span>
<span><span class="va">loading2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># for 2nd objective, true value = 1.5</span></span>
<span><span class="va">loading.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">loading1</span>, <span class="va">loading2</span><span class="op">)</span></span></code></pre></div>
<p>Conduct Inference, call <code>LF</code> with
<code>model="linear"</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="../reference/LF.html">LF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"linear"</span>, intercept<span class="op">=</span><span class="cn">TRUE</span>, intercept.loading<span class="op">=</span><span class="cn">FALSE</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ---&gt; Computing for loading (1/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.044356at step =4</span></span>
<span><span class="co">#&gt; ---&gt; Computing for loading (2/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.044356at step =4</span></span></code></pre></div>
<p>The parameter <code>intercept</code> indicates whether we fit the
model with/without intercept term. The parameter
<code>intercept.loading</code> indicates whether we include intercept
term in the inference objective. In this example, the model is fitted
with intercept, but we do not include it in our final objective.</p>
<p>Methods for <code>LF</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading     lower     upper</span></span>
<span><span class="co">#&gt; 1       1 0.4892515 0.5115561</span></span>
<span><span class="co">#&gt; 2       2 1.4886438 1.5184631</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Linear Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;        1     0.4764     0.5004   0.005690   87.94        0 ***</span></span>
<span><span class="co">#&gt;        2     1.4533     1.5036   0.007607  197.65        0 ***</span></span></code></pre></div>
<p>Notice that the true values are <span class="math inline">\(0.5\)</span> and <span class="math inline">\(1.5\)</span> for 1st and 2nd objective
respectively, both are included in their corresponding confidence
interval. Also it is evident that our bias-corrected estimators is much
closer to the true values than the Lasso estimators.</p>
</div>
<div class="section level4">
<h4 id="qf-quadratic-functionals">QF: Quadratic Functionals<a class="anchor" aria-label="anchor" href="#qf-quadratic-functionals"></a>
</h4>
<p>For quadratic functionals, we need to specify the subset <span class="math inline">\(G \subseteq [p]\)</span>. If argument <span class="math inline">\(A\)</span> is not specified (default = NULL), we
will automatically conduct inference on <span class="math inline">\(\beta_G \Sigma_{G,G} \beta_G\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="co"># 3rd objective, true value = 3.25</span></span></code></pre></div>
<p>Conduct Inference, call <code>QF</code> with
<code>model="linear"</code>. The argument <code>split</code> indicates
whether we split samples or not for computing the initial estimator.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="../reference/QF.html">QF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">G</span>, A<span class="op">=</span><span class="cn">NULL</span>, model<span class="op">=</span><span class="st">"linear"</span>, intercept<span class="op">=</span><span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.062729at step =3</span></span></code></pre></div>
<p><code>ci</code> method for QF</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tau    lower    upper</span></span>
<span><span class="co">#&gt; 1 0.25 2.239521 3.890422</span></span>
<span><span class="co">#&gt; 2 0.50 2.233725 3.896219</span></span>
<span><span class="co">#&gt; 3 1.00 2.222250 3.907693</span></span></code></pre></div>
<p><code>summary</code> method for QF</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Quadratic Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   tau est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;  0.25        2.9      3.065     0.4212   7.278 3.400e-13 ***</span></span>
<span><span class="co">#&gt;  0.50        2.9      3.065     0.4241   7.227 4.947e-13 ***</span></span>
<span><span class="co">#&gt;  1.00        2.9      3.065     0.4300   7.128 1.016e-12 ***</span></span></code></pre></div>
<p>In the output results, each row represents the result for different
values of <span class="math inline">\(\tau\)</span>, the enlargement
factor for asymptotic variance to handle super-efficiency. Notice that
the true value is <span class="math inline">\(3.25\)</span> for 3rd
objective, which is included in the confidence interval.</p>
</div>
</div>
<div class="section level3">
<h3 id="logistic-regression-setting">Logistic Regression Setting<a class="anchor" aria-label="anchor" href="#logistic-regression-setting"></a>
</h3>
<p>The procedures of usage in the logistic regression setting are almost
the same as the one in linear setting, except that we need to specify
the argument <code>model="logistic"</code> or
<code>model="logistic_alter"</code>, instead of
<code>model="linear"</code>. We propose two different debiasing methods
for logistic regression, both work theoretically and empiricially.</p>
<p>We consider the setting that <span class="math inline">\(n=200,
p=150\)</span> with <span class="math display">\[
X_i \sim N(\textbf{0}_p, \textbf{I}_p),\; P_i = \frac{\exp(\alpha +
X_i^\intercal \beta)}{1+\exp(\alpha + X_i^\intercal \beta)},\; Y_i =
{\rm Binomial}(P_i),\;
\textrm{where }\; \alpha = -0.5, \;\beta = (0.5, 1, \textbf{0}_{p-2}).
\]</span> Our goal is to construct valid inference for objectives:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\beta_1 + \beta_2 = 1.5\)</span></li>
<li><span class="math inline">\(-\frac{1}{2}\beta_1 - \beta_2 =
-1.25\)</span></li>
<li>
<span class="math inline">\(\beta_{G}^\intercal \Sigma_{G,G}
\beta_{G} = 1.25\)</span>, where <span class="math inline">\(\Sigma=\mathbb{E}[X_i^\intercal X_i] =
\textbf{I}_p\)</span> and <span class="math inline">\(G=\{1,2,3\}\)</span>.</li>
</ol>
<p>The 1st and 2nd objectives will be achieved togther by <em>LF(
)</em>, while the 3d objective will be conducted with <em>QF(
)</em>.</p>
<p>Generate Data</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">200</span>; <span class="va">p</span> <span class="op">=</span> <span class="fl">120</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">val</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">1</span></span>
<span><span class="va">prob</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="lf-linear-functionals-1">LF: Linear Functionals<a class="anchor" aria-label="anchor" href="#lf-linear-functionals-1"></a>
</h4>
<p>Loadings for Linear Functionals</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loading1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># for 1st objective, true value = 1.5</span></span>
<span><span class="va">loading2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># for 2nd objective, true value = -1.25</span></span>
<span><span class="va">loading.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">loading1</span>, <span class="va">loading2</span><span class="op">)</span></span></code></pre></div>
<p>Conduct Inference, call <code>LF</code> with
<code>model="logistic"</code> or
<code>model="logistic_alter"</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="../reference/LF.html">LF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"logistic"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; ---&gt; Computing for loading (1/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.028911at step =5</span></span>
<span><span class="co">#&gt; ---&gt; Computing for loading (2/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.028911at step =5</span></span></code></pre></div>
<p>Methods for <code>LF</code></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading      lower     upper</span></span>
<span><span class="co">#&gt; 1       1  0.6510009  1.866141</span></span>
<span><span class="co">#&gt; 2       2 -1.3927844 -0.424308</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Linear Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;        1     0.3745     1.2586     0.3100   4.060 4.907e-05 ***</span></span>
<span><span class="co">#&gt;        2    -0.2762    -0.9085     0.2471  -3.677 2.357e-04 ***</span></span></code></pre></div>
<p>Notice that the true values are <span class="math inline">\(1.5\)</span> and <span class="math inline">\(-1.25\)</span> for 1st and 2nd objective
respectively, both are included in their corresponding confidence
interval. Also it is evident that our bias-corrected estimators is much
closer to the true values than the Lasso estimators.</p>
</div>
<div class="section level4">
<h4 id="qf-quadratic-functionals-1">QF: Quadratic Functionals<a class="anchor" aria-label="anchor" href="#qf-quadratic-functionals-1"></a>
</h4>
<p>For quadratic functionals, we find that sufficient larger sample size
is needed for better empirical result, since we need to split samples to
obtain initial estimators. Thus, we generate another simulated data but
with larger sample size <span class="math inline">\(n=400\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">400</span>; <span class="va">p</span> <span class="op">=</span> <span class="fl">120</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">n</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">val</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">1</span></span>
<span><span class="va">prob</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="co"># 3rd objective, true value = 1.25</span></span></code></pre></div>
<p>Conduct Inference, call <code>QF</code> with
<code>model="logistic_alter"</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="../reference/QF.html">QF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">G</span>, A<span class="op">=</span><span class="cn">NULL</span>, model<span class="op">=</span><span class="st">"logistic_alter"</span>, intercept<span class="op">=</span><span class="cn">TRUE</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.029056at step =5</span></span></code></pre></div>
<p><code>ci</code> method for QF</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tau     lower    upper</span></span>
<span><span class="co">#&gt; 1 0.25 0.2274503 2.048520</span></span>
<span><span class="co">#&gt; 2 0.50 0.1339998 2.141970</span></span>
<span><span class="co">#&gt; 3 1.00 0.0000000 2.306665</span></span></code></pre></div>
<p><code>summary</code> method for QF</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Quadratic Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   tau est.plugin est.debias Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt;  0.25     0.6434      1.138     0.4646   2.450  0.01430 *</span></span>
<span><span class="co">#&gt;  0.50     0.6434      1.138     0.5122   2.222  0.02631 *</span></span>
<span><span class="co">#&gt;  1.00     0.6434      1.138     0.5963   1.908  0.05633 .</span></span></code></pre></div>
<p>In the output results, each row represents the result for different
values of <span class="math inline">\(\tau\)</span>, the enlargement
factor for asymptotic variance to handle super-efficiency. Notice that
the true value is <span class="math inline">\(3.25\)</span> for 3rd
objective, which is included in the confidence interval.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zhenyu Wang, Prabrisha Rakshit, Tony Cai, Zijian Guo.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
  <p class="preferably">Using <a href="https://preferably.amirmasoudabdol.name/?source=footer" class="external-link">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
