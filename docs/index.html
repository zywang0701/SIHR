<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The goal of SIHR is to provide inference procedures in the high-dimensional setting for 
    (1) linear functionals in generalized linear regression (Cai et al. (2019) &lt;arXiv:1904.12891&gt;, Guo et al. (2020) &lt;arXiv:2012.07133&gt;, Cai et al. (2021)),
    (2) conditional average treatment effects in generalized linear regression,
    (3) quadratic functionals in generalized linear regression (Guo et al. (2019) &lt;arXiv:1909.01503&gt;).
    (4) inner product in generalized linear regression
    (5) distance in generalized linear regression.">
<title>Statistical Inference in High Dimensional Regression • SIHR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Statistical Inference in High Dimensional Regression">
<meta property="og:description" content="The goal of SIHR is to provide inference procedures in the high-dimensional setting for 
    (1) linear functionals in generalized linear regression (Cai et al. (2019) &lt;arXiv:1904.12891&gt;, Guo et al. (2020) &lt;arXiv:2012.07133&gt;, Cai et al. (2021)),
    (2) conditional average treatment effects in generalized linear regression,
    (3) quadratic functionals in generalized linear regression (Guo et al. (2019) &lt;arXiv:1909.01503&gt;).
    (4) inner product in generalized linear regression
    (5) distance in generalized linear regression.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">SIHR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/prabrishar1/SIHR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sihr">SIHR<a class="anchor" aria-label="anchor" href="#sihr"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of SIHR is to provide inference procedures in the high-dimensional setting for (1) linear functionals in generalized linear regression, (2) conditional average treatment effects in generalized linear regression (CATE), (3) quadratic functionals in generalized linear regression (QF) (4) inner product in generalized linear regression (InnProd) and (5) distance in generalized linear regression (Dist).</p>
<p>Currently, we support different generalized linear regression, by specifying the argument <code>model</code> in “linear”, “logisitc”, “logistic_alter”.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"prabrishar1/SIHR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>These are basic examples which show how to solve the common high-dimensional inference problems:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/prabrishar1/SIHR" class="external-link">SIHR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="linear-functional-in-linear-regression-model---1">Linear functional in linear regression model - 1<a class="anchor" aria-label="anchor" href="#linear-functional-in-linear-regression-model---1"></a>
</h3>
<p>Generate Data and find the truth linear functionals:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">loading1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">loading1</span>, <span class="va">loading2</span><span class="op">)</span></span>
<span><span class="co">## consider the intercept.loading=FALSE</span></span>
<span><span class="va">truth1</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fl">1</span></span>
<span><span class="va">truth2</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">truth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">truth1</span>, <span class="va">truth2</span><span class="op">)</span></span>
<span><span class="va">truth</span></span>
<span><span class="co">#&gt; [1]  1.50 -1.25</span></span></code></pre></div>
<p>In the example, the linear functional does not involve the intercept term, so we set <code>intercept.loading=FALSE</code> (default). If users want to include the intercept term, please set <code>intercept.loading=TRUE</code>, such that truth1 = -0.5 + 1.5 = 1; truth2 = -0.5 - 1.25 = -1.75</p>
<p>Call <code>LF</code> with <code>model="linear"</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/LF.html">LF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"linear"</span>, intercept<span class="op">=</span><span class="cn">TRUE</span>, intercept.loading<span class="op">=</span><span class="cn">FALSE</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing LF for loading (1/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.061329at step =3</span></span>
<span><span class="co">#&gt; Computing LF for loading (2/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.061329at step =3</span></span></code></pre></div>
<p><code>ci</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading     lower     upper</span></span>
<span><span class="co">#&gt; 1       1  1.111919  1.722561</span></span>
<span><span class="co">#&gt; 2       2 -1.529687 -1.020350</span></span></code></pre></div>
<p>Note that both true values are included in their corresponding confidence intervals.</p>
<p><code>summary</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Linear Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;        1      1.158      1.417     0.1558   9.098 0.000e+00 ***</span></span>
<span><span class="co">#&gt;        2     -1.015     -1.275     0.1299  -9.813 9.924e-23 ***</span></span></code></pre></div>
<p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function returns the summary statistics, including the plugin estimator, the bias-corrected estimator, standard errors.</p>
</div>
<div class="section level3">
<h3 id="linear-functional-in-linear-regression-model---2">Linear functional in linear regression model - 2<a class="anchor" aria-label="anchor" href="#linear-functional-in-linear-regression-model---2"></a>
</h3>
<p>Sometimes, we may be interested in multiple linear functionals, each with a separate loading. To be computationally efficient, we can specify the argument <code>beta.init</code> first, so that the program can save time to compute the initial estimator repeatedly.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">loading.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">120</span>, ncol<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">loading.mat</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">loading.mat</span><span class="op">[</span><span class="va">i</span>,<span class="va">i</span><span class="op">]</span> <span class="op">=</span>  <span class="fl">1</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-4</span></span>
<span><span class="va">cvfit</span> <span class="op">=</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, alpha <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span>, standardize <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">beta.init</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">cvfit</span>, s <span class="op">=</span> <span class="va">cvfit</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Call <code>LF</code> with <code>model="linear"</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/LF.html">LF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"linear"</span>, intercept<span class="op">=</span><span class="cn">TRUE</span>, beta.init<span class="op">=</span><span class="va">beta.init</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code>ci</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;    loading       lower     upper</span></span>
<span><span class="co">#&gt; 1        1  0.01511794 0.7789204</span></span>
<span><span class="co">#&gt; 2        2  0.17744949 1.2347802</span></span>
<span><span class="co">#&gt; 3        3  0.14589125 0.9074732</span></span>
<span><span class="co">#&gt; 4        4  0.05357240 0.7355096</span></span>
<span><span class="co">#&gt; 5        5  0.18122547 1.0292098</span></span>
<span><span class="co">#&gt; 6        6 -0.30397428 0.7048378</span></span>
<span><span class="co">#&gt; 7        7  0.33282671 0.9970891</span></span>
<span><span class="co">#&gt; 8        8  0.01564265 0.7708467</span></span>
<span><span class="co">#&gt; 9        9  0.46020627 1.0619827</span></span>
<span><span class="co">#&gt; 10      10  0.12026114 0.7637474</span></span></code></pre></div>
<p><code>summary</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Linear Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;        1     0.2698     0.3970     0.1949  2.0376 4.159e-02   *</span></span>
<span><span class="co">#&gt;        2     0.4145     0.7061     0.2697  2.6178 8.849e-03  **</span></span>
<span><span class="co">#&gt;        3     0.4057     0.5267     0.1943  2.7109 6.711e-03  **</span></span>
<span><span class="co">#&gt;        4     0.2631     0.3945     0.1740  2.2679 2.333e-02   *</span></span>
<span><span class="co">#&gt;        5     0.3773     0.6052     0.2163  2.7977 5.147e-03  **</span></span>
<span><span class="co">#&gt;        6     0.2730     0.2004     0.2574  0.7788 4.361e-01    </span></span>
<span><span class="co">#&gt;        7     0.3664     0.6650     0.1695  3.9240 8.708e-05 ***</span></span>
<span><span class="co">#&gt;        8     0.2911     0.3932     0.1927  2.0412 4.124e-02   *</span></span>
<span><span class="co">#&gt;        9     0.5699     0.7611     0.1535  4.9577 7.133e-07 ***</span></span>
<span><span class="co">#&gt;       10     0.2839     0.4420     0.1642  2.6926 7.091e-03  **</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="linear-functional-in-logistic-regression-model">Linear functional in logistic regression model<a class="anchor" aria-label="anchor" href="#linear-functional-in-logistic-regression-model"></a>
</h3>
<p>Generate Data and find the truth linear functionals:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">exp_val</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1</span></span>
<span><span class="va">prob</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">exp_val</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">exp_val</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">## loadings</span></span>
<span><span class="va">loading1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">loading1</span>, <span class="va">loading2</span><span class="op">)</span></span>
<span><span class="co">## consider the intercept.loading=TRUE</span></span>
<span><span class="va">truth1</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="fl">1</span></span>
<span><span class="va">truth2</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">truth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">truth1</span>, <span class="va">truth2</span><span class="op">)</span></span>
<span><span class="va">truth.prob</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">truth</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">truth</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">truth</span>; <span class="va">truth.prob</span></span>
<span><span class="co">#&gt; [1]  1.50 -1.25</span></span>
<span><span class="co">#&gt; [1] 0.8175745 0.2227001</span></span></code></pre></div>
<p>Call <code>LF</code> with <code>model="logistic"</code> or <code>model="logistic_alter"</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## model = "logisitc"</span></span>
<span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/LF.html">LF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"logistic"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing LF for loading (1/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.061329at step =3</span></span>
<span><span class="co">#&gt; Computing LF for loading (2/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.061329at step =3</span></span></code></pre></div>
<p><code>ci</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## confidence interval for linear combination</span></span>
<span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading      lower      upper</span></span>
<span><span class="co">#&gt; 1       1  0.6393023  2.2699716</span></span>
<span><span class="co">#&gt; 2       2 -1.9644387 -0.5538893</span></span>
<span><span class="co">## confidence interval after probability transformation</span></span>
<span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading     lower     upper</span></span>
<span><span class="co">#&gt; 1       1 0.6545957 0.9063594</span></span>
<span><span class="co">#&gt; 2       2 0.1229875 0.3649625</span></span></code></pre></div>
<p><code>summary</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Linear Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;        1     0.8116      1.455     0.4160   3.497 0.0004709 ***</span></span>
<span><span class="co">#&gt;        2    -0.8116     -1.259     0.3598  -3.499 0.0004666 ***</span></span></code></pre></div>
<p>Call <code>LF</code> with <code>model="logistic_alter"</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## model = "logistic_alter"</span></span>
<span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/LF.html">LF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"logistic_alter"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing LF for loading (1/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.061329at step =3</span></span>
<span><span class="co">#&gt; Computing LF for loading (2/2)... </span></span>
<span><span class="co">#&gt; The projection direction is identified at mu = 0.061329at step =3</span></span></code></pre></div>
<p><code>ci</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## confidence interval for linear combination</span></span>
<span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading      lower     upper</span></span>
<span><span class="co">#&gt; 1       1  0.6077181  2.191417</span></span>
<span><span class="co">#&gt; 2       2 -1.8922856 -0.530151</span></span>
<span><span class="co">## confidence interval after probability transformation</span></span>
<span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading     lower     upper</span></span>
<span><span class="co">#&gt; 1       1 0.6474201 0.8994761</span></span>
<span><span class="co">#&gt; 2       2 0.1309841 0.3704817</span></span></code></pre></div>
<p><code>summary</code> method for <code>LF</code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Linear Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;        1     0.7942      1.400     0.4040   3.464 0.0005319 ***</span></span>
<span><span class="co">#&gt;        2    -0.7942     -1.211     0.3475  -3.486 0.0004910 ***</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="conditional-average-treatment-effect-in-linear-regression-model">Conditional Average Treatment Effect in linear regression model<a class="anchor" aria-label="anchor" href="#conditional-average-treatment-effect-in-linear-regression-model"></a>
</h3>
<p>Generate Data and find the truth linear functionals:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">## 1st data</span></span>
<span><span class="va">X1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="va">X1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">## 2nd data</span></span>
<span><span class="va">X2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">=</span> <span class="fl">0.1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="va">X2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">## loadings</span></span>
<span><span class="va">loading1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">loading1</span>, <span class="va">loading2</span><span class="op">)</span></span>
<span><span class="va">truth1</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1.8</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1.8</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.5</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">truth2</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1.8</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1.8</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">-</span> <span class="op">(</span><span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">truth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">truth1</span>, <span class="va">truth2</span><span class="op">)</span></span>
<span><span class="va">truth</span></span>
<span><span class="co">#&gt; [1]  2.10 -1.45</span></span></code></pre></div>
<p>Call <code>CATE</code> with <code>model="linear"</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/CATE.html">CATE</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">y1</span>, <span class="va">X2</span>, <span class="va">y2</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"linear"</span><span class="op">)</span></span></code></pre></div>
<p><code>ci</code> method for <code>CATE</code></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading     lower      upper</span></span>
<span><span class="co">#&gt; 1       1  1.338908  2.9843155</span></span>
<span><span class="co">#&gt; 2       2 -1.931858 -0.9300702</span></span></code></pre></div>
<p><code>summary</code> method for <code>CATE</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Treatment Effect</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;        1      1.991      2.162     0.4198   5.150 2.609e-07 ***</span></span>
<span><span class="co">#&gt;        2     -1.321     -1.431     0.2556  -5.599 2.153e-08 ***</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="conditional-average-treatment-effect-in-logistic-regression-model">Conditional Average Treatment Effect in logistic regression model<a class="anchor" aria-label="anchor" href="#conditional-average-treatment-effect-in-logistic-regression-model"></a>
</h3>
<p>Generate Data and find the truth linear functionals:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">## 1st data</span></span>
<span><span class="va">X1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">exp_val1</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="va">X1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1</span></span>
<span><span class="va">prob1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">exp_val1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">exp_val1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="va">prob1</span><span class="op">)</span></span>
<span><span class="co">## 2nd data</span></span>
<span><span class="va">X2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">120</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">exp_val2</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="va">X2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.8</span> <span class="op">+</span> <span class="va">X2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.8</span></span>
<span><span class="va">prob2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">exp_val2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">exp_val2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="va">prob2</span><span class="op">)</span></span>
<span><span class="co">## loadings</span></span>
<span><span class="va">loading1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">118</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">loading.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">loading1</span>, <span class="va">loading2</span><span class="op">)</span></span>
<span><span class="va">truth1</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1.8</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1.8</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.5</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">truth2</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0.8</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">truth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">truth1</span>, <span class="va">truth2</span><span class="op">)</span></span>
<span><span class="va">prob.fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">truth.prob1</span> <span class="op">=</span> <span class="fu">prob.fun</span><span class="op">(</span><span class="fl">1.8</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1.8</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fu">prob.fun</span><span class="op">(</span><span class="fl">0.5</span><span class="op">*</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">truth.prob2</span> <span class="op">=</span> <span class="fu">prob.fun</span><span class="op">(</span><span class="fl">1.8</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1.8</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu">prob.fun</span><span class="op">(</span><span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">truth.prob</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">truth.prob1</span>, <span class="va">truth.prob2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">truth</span>; <span class="va">truth.prob</span></span>
<span><span class="co">#&gt; [1] 2.10 0.05</span></span>
<span><span class="co">#&gt; [1]  0.1558285 -0.1597268</span></span></code></pre></div>
<p>Call <code>CATE</code> with <code>model="logistic"</code> or <code>model="logisitc_alter"</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/CATE.html">CATE</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">y1</span>, <span class="va">X2</span>, <span class="va">y2</span>, <span class="va">loading.mat</span>, model<span class="op">=</span><span class="st">"logistic"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code>ci</code> method for <code>CATE</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## confidence interval for linear combination</span></span>
<span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading      lower    upper</span></span>
<span><span class="co">#&gt; 1       1 -0.4253334 3.397421</span></span>
<span><span class="co">#&gt; 2       2 -3.3720814 1.259623</span></span>
<span><span class="co">## confidence interval after probability transformation</span></span>
<span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span>, probability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   loading       lower      upper</span></span>
<span><span class="co">#&gt; 1       1 -0.01213062 0.28746833</span></span>
<span><span class="co">#&gt; 2       2 -0.34578964 0.08603778</span></span></code></pre></div>
<p><code>summary</code> method for <code>CATE</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Treatment Effect</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimators: </span></span>
<span><span class="co">#&gt;  loading est.plugin est.debias Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt;        1     0.9234      1.486     0.9752  1.5238   0.1276  </span></span>
<span><span class="co">#&gt;        2    -0.3643     -1.056     1.1816 -0.8939   0.3714</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quadratic-functional-in-linear-regression">Quadratic functional in linear regression<a class="anchor" aria-label="anchor" href="#quadratic-functional-in-linear-regression"></a>
</h3>
<p>Generate Data and find the truth quadratic functionals:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">A1gen</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rho</span>, <span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="va">p</span>, ncol<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span> <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span> <span class="va">M</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="va">rho</span><span class="op">^</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="va">j</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="va">M</span></span>
<span><span class="op">}</span></span>
<span><span class="va">Cov</span> <span class="op">=</span> <span class="fu">A1gen</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">150</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">400</span>, mu<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span><span class="op">)</span>, Sigma<span class="op">=</span><span class="va">Cov</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150</span><span class="op">)</span>; <span class="va">beta</span><span class="op">[</span><span class="fl">25</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">test.set</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span><span class="op">:</span><span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">truth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="va">test.set</span><span class="op">]</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">Cov</span><span class="op">[</span><span class="va">test.set</span>, <span class="va">test.set</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta</span><span class="op">[</span><span class="va">test.set</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">truth</span></span>
<span><span class="co">#&gt; [1] 0.5800391</span></span></code></pre></div>
<p>Call <code>QF</code> with <code>model="linear"</code> with intial estimator given:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span>
<span><span class="va">outLas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                            intercept <span class="op">=</span> <span class="cn">T</span>, standardize <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">beta.init</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">outLas</span>, s <span class="op">=</span> <span class="va">outLas</span><span class="op">$</span><span class="va">lambda.min</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/QF.html">QF</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, G<span class="op">=</span><span class="va">test.set</span>, A<span class="op">=</span><span class="cn">NULL</span>, model<span class="op">=</span><span class="st">"linear"</span>, beta.init<span class="op">=</span><span class="va">beta.init</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code>ci</code> method for <code>QF</code></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tau     lower     upper</span></span>
<span><span class="co">#&gt; 1 0.25 0.4397755 0.7416457</span></span>
<span><span class="co">#&gt; 2 0.50 0.4320213 0.7494000</span></span>
<span><span class="co">#&gt; 3 1.00 0.4175514 0.7638699</span></span></code></pre></div>
<p><code>summary</code> method for <code>QF</code></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Quadratic Functional</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   tau est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;  0.25     0.4547     0.5907    0.07701   7.671 1.710e-14 ***</span></span>
<span><span class="co">#&gt;  0.50     0.4547     0.5907    0.08097   7.296 2.969e-13 ***</span></span>
<span><span class="co">#&gt;  1.00     0.4547     0.5907    0.08835   6.686 2.291e-11 ***</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inner-product-in-linear-regression-model">Inner product in linear regression model<a class="anchor" aria-label="anchor" href="#inner-product-in-linear-regression-model"></a>
</h3>
<p>Generate Data and find the true inner product:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fl">120</span></span>
<span><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">)</span></span>
<span><span class="va">Cov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">## 1st data</span></span>
<span><span class="va">n1</span> <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="va">X1</span> <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n1</span>,<span class="va">mu</span>,<span class="va">Cov</span><span class="op">)</span></span>
<span><span class="va">beta1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>; <span class="va">beta1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">=</span> <span class="va">X1</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span></span>
<span><span class="co">## 2nd data</span></span>
<span><span class="va">n2</span> <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="va">X2</span> <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n2</span>,<span class="va">mu</span>,<span class="va">Cov</span><span class="op">)</span></span>
<span><span class="va">beta2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>; <span class="va">beta2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">=</span> <span class="va">X2</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span></span>
<span><span class="co">## test.set</span></span>
<span><span class="va">G</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">beta1</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">Cov</span><span class="op">[</span><span class="va">G</span>,<span class="va">G</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta2</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">truth</span></span>
<span><span class="co">#&gt; [1] 1.7</span></span></code></pre></div>
<p>Call <code>InnProd</code> with <code>model="linear"</code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/InnProd.html">InnProd</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">y1</span>, <span class="va">X2</span>, <span class="va">y2</span>, <span class="va">G</span>, model<span class="op">=</span><span class="st">"linear"</span><span class="op">)</span></span></code></pre></div>
<p><code>ci</code> method for <code>InnProd</code></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tau     lower    upper</span></span>
<span><span class="co">#&gt; 1 0.25 0.8118224 2.376767</span></span>
<span><span class="co">#&gt; 2 0.50 0.7628233 2.425767</span></span>
<span><span class="co">#&gt; 3 1.00 0.6648251 2.523765</span></span></code></pre></div>
<p><code>summary</code> method for <code>InnProd</code></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Inner Product</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   tau est.plugin est.debias Std. Error z value  Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt;  0.25     0.9745      1.594     0.3992   3.993 6.512e-05 ***</span></span>
<span><span class="co">#&gt;  0.50     0.9745      1.594     0.4242   3.758 1.712e-04 ***</span></span>
<span><span class="co">#&gt;  1.00     0.9745      1.594     0.4742   3.362 7.742e-04 ***</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="distance-in-linear-regression-model">Distance in linear regression model<a class="anchor" aria-label="anchor" href="#distance-in-linear-regression-model"></a>
</h3>
<p>Generate Data and find the true distance:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fl">120</span></span>
<span><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">)</span></span>
<span><span class="va">Cov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">## 1st data</span></span>
<span><span class="va">n1</span> <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="va">X1</span> <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n1</span>,<span class="va">mu</span>,<span class="va">Cov</span><span class="op">)</span></span>
<span><span class="va">beta1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>; <span class="va">beta1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y1</span> <span class="op">=</span> <span class="va">X1</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span></span>
<span><span class="co">## 2nd data</span></span>
<span><span class="va">n2</span> <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="va">X2</span> <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">n2</span>,<span class="va">mu</span>,<span class="va">Cov</span><span class="op">)</span></span>
<span><span class="va">beta2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>; <span class="va">beta2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">1.8</span><span class="op">)</span></span>
<span><span class="va">y2</span> <span class="op">=</span> <span class="va">X2</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span></span>
<span><span class="co">## test.set</span></span>
<span><span class="va">G</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">beta1</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">-</span><span class="va">beta2</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="op">(</span><span class="va">beta1</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">-</span><span class="va">beta2</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">truth</span></span>
<span><span class="co">#&gt; [1] 2.33</span></span></code></pre></div>
<p>Call <code>Dist</code> with <code>model="linear"</code>:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Est</span> <span class="op">=</span> <span class="fu"><a href="reference/Dist.html">Dist</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">y1</span>, <span class="va">X2</span>, <span class="va">y2</span>, <span class="va">G</span>, model<span class="op">=</span><span class="st">"linear"</span>, A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><code>ci</code> method for <code>Dist</code></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ci.html">ci</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt;    tau     lower    upper</span></span>
<span><span class="co">#&gt; 1 0.25 0.7528571 3.721829</span></span>
<span><span class="co">#&gt; 2 0.50 0.7038580 3.770828</span></span>
<span><span class="co">#&gt; 3 1.00 0.6058598 3.868826</span></span></code></pre></div>
<p><code>summary</code> method for <code>Dist</code></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Est</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; Inference for Distance</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   tau est.plugin est.debias Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">#&gt;  0.25      1.716      2.237     0.7574   2.954 0.003137 **</span></span>
<span><span class="co">#&gt;  0.50      1.716      2.237     0.7824   2.860 0.004242 **</span></span>
<span><span class="co">#&gt;  1.00      1.716      2.237     0.8324   2.688 0.007192 **</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=SIHR" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/prabrishar1/SIHR/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SIHR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zhenyu Wang <br><small class="roles"> Author, maintainer </small>  </li>
<li>Prabrisha Rakshit <br><small class="roles"> Author </small>  </li>
<li>Tony Cai <br><small class="roles"> Author </small>  </li>
<li>Zijian Guo <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zhenyu Wang, Prabrisha Rakshit, Tony Cai, Zijian Guo.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
